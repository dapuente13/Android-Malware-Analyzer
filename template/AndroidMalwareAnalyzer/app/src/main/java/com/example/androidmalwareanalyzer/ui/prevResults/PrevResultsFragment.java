package com.example.androidmalwareanalyzer.ui.prevResults;

import android.os.Bundle;
import android.view.LayoutInflater;
import android.view.View;
import android.view.ViewGroup;

import androidx.annotation.NonNull;
import androidx.fragment.app.Fragment;
import androidx.fragment.app.FragmentManager;
import androidx.recyclerview.widget.LinearLayoutManager;
import androidx.recyclerview.widget.RecyclerView;

import com.example.androidmalwareanalyzer.R;

import java.util.ArrayList;
import java.util.List;

public class PrevResultsFragment extends Fragment {
    private RecyclerView mRecyclerView;
    private RecyclerView.Adapter mAdapter;
    private List<PrevResultsDB.PrevResultsValues> resultsList;

    public View onCreateView(@NonNull LayoutInflater inflater, ViewGroup container, Bundle savedInstanceState) {
        View root = inflater.inflate(R.layout.fragment_prev_results, container, false);

        //PrevResultsDB db = new PrevResultsDB(getContext());
        //List<PrevResultsDB.PrevResultsValues> resultsList = db.readAllFromDB();
        //db.closeDB();
        //---------------------------------------------------------------------------
        List<PrevResultsDB.PrevResultsValues> resultsList = new ArrayList<PrevResultsDB.PrevResultsValues>();
        for (int i = 0; i < 7; ++i) {
            PrevResultsDB.PrevResultsValues val = new PrevResultsDB.PrevResultsValues();
            val.id = i;
            val.date = "2021-06-05 00:64:34";
            val.analysis_type = "Log analysis result";
            val.apps_analysed = "camera,bluetooth,com.example.androidmalwareanalyzer,";
            val.analysis_result = "asdkfjapsidfjÃ± asdsadf psdjf pasdn fasdnf pasd fpasdj fpsadn fpisadnf isadn fpisad fpisadnbf asidfb siadfb sadiofb soaidfb oaisdbf asb";

            resultsList.add(val);
        }//-----------------------------------------------------------------------------

        mRecyclerView = root.findViewById(R.id.prev_results_list);
        LinearLayoutManager layoutManager = new LinearLayoutManager(getContext());
        mRecyclerView.setLayoutManager(layoutManager);

        mAdapter = new PrevResultsAdapter(getContext(), resultsList, this);

        mRecyclerView.setAdapter(mAdapter);

        return root;
    }

    void onSelected(String analysis_type, String analysis_date, String elements_analyzed, String msg) {
        ShowResult fragment = new ShowResult(getContext(), analysis_type, analysis_date, elements_analyzed, msg);
        FragmentManager manager = getParentFragmentManager();
        manager.beginTransaction().replace(R.id.nav_host_fragment, fragment, fragment.getTag()).commit();
    }
}