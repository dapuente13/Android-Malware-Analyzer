package com.example.androidmalwareanalyzer.ui.permissionAnalyzer;

import android.content.pm.PackageInfo;

import com.example.androidmalwareanalyzer.ui.MalwareDB;

import java.util.ArrayList;
import java.util.HashMap;
import java.util.List;

public class AppScore {
    private MalwareDB dbHelper;
    //APP
    private PackageInfo app;
    //NAME
    private String name;
    //APP FILLED/NOT FILLED
    private boolean filled = true;
    //SCORE
    private List<String> unk = new ArrayList<>();
    private List<String> norm = new ArrayList<>();
    private List<String> sig = new ArrayList<>();
    private List<String> danger = new ArrayList<>();
    private List<String> deprec = new ArrayList<>();
    private List<String> prohib = new ArrayList<>();
    //DOMAIN
    private HashMap<String, List<String>> domain = new HashMap<>();

    //BASE CONSTRUCTOR
    public AppScore(PackageInfo app){ this.app = app; }
    //EMPTY CONSTRUCTOR
    public AppScore(String perm){
        name = "No " + perm + "found";
        filled = false;
    }

    //GETS
    public PackageInfo getPInfo(){ return app; }
    public boolean Filled(){ return filled; }
    public HashMap<String, List<String>> getDomain(){ return domain; }
    public List<String> getUnk(){ return unk; }
    public List<String> getNorm(){ return norm; }
    public List<String> getSig(){ return sig; }
    public List<String> getDangerous(){ return danger; }
    public List<String> getDeprec(){ return deprec; }
    public List<String> getProhib(){ return prohib; }
    public String getName(){ return name; }

    //SETS
    public void setFilled(boolean filled){ this.filled = filled;}
    public void setDomain(String group, String perm, String desc){
        if (domain.containsKey(group)) {
            domain.get(group).add(perm);
        }
        else{
            List<String> list = new ArrayList<>();
            list.add(desc+"\nPermissions found:");
            list.add(perm);
            domain.put(group, list);
        }
    }
    public void setUnk(String perm){ unk.add(perm); }
    public void setNorm(String perm){ norm.add(perm); }
    public void setSig(String perm){ sig.add(perm); }
    public void setDangerous(String perm){ danger.add(perm); }
    public void setDeprec(String perm){ deprec.add(perm); }
    public void setProhib(String perm){ prohib.add(perm); }


}
